pico-8 cartridge // http://www.pico-8.com
version 22
__lua__
-- game loop

function _init()
  ball_init()
end

function _update()
  ball_move()
end

function _draw()
  cls()
  map(0,0,0,0)

  ball_draw()
end


-->8
-- ball functions

function ball_init()
  b={}
  b.spr=2
  b.x=32
  b.y=32
  b.xd=1
  b.yd=-1
end

function ball_move()
  next_x = b.x + b.xd
  next_y = b.y + b.yd

  if is_ceil(next_x, next_y) then
    sfx(0)
    b.yd *= -1
  end 
  
  if is_wall(next_x, next_y) then
    sfx(0)
    b.xd *= -1
  end

  b.x += b.xd
  b.y += b.yd
end

function ball_draw()
  spr(b.spr, b.x, b.y, 0.25, 0.25)
end

-->8
-- util functions

function col(x)
  return flr(x/8)
end

function row(y)
  return flr(y/8)
end

function tile_at(x,y)
  return mget(col(x), row(y))
end

function is_ceil(x,y)
  tile = tile_at(x,y)
  return fget(tile, 0) and fget(tile,1)
end

function is_wall(x,y)
  tile = tile_at(x,y)
  return fget(tile, 0) and fget(tile,2)
end

__gfx__
00000000770000007700000077777777000000007000000000000007000000000000000070000000000000070000000000000000000000000000000000000000
00000000770000007700000000000000000000007000000000000007000000000000000000000000000000000000000000000000000000000000000000000000
00700700770000000000000000000000000000007000000000000007000000000000000000000000000000000000000000000000000000000000000000000000
00077000770000000000000000000000000000007000000000000007000000000000000000000000000000000000000000000000000000000000000000000000
00077000770000000000000000000000000000007000000000000007000000000000000000000000000000000000000000000000000000000000000000000000
00700700770000000000000000000000000000007000000000000007000000000000000000000000000000000000000000000000000000000000000000000000
00000000770000000000000000000000000000007000000000000007000000000000000000000000000000000000000000000000000000000000000000000000
00000000770000000000000000000000777777777000000000000007700000000000000700000000000000000000000000000000000000000000000000000000
00000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000303050507070707010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0804040404040404040404040404040700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a03030303030303030303030303030900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000200000b0501a050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
